# See the project's README about setting DATAFOLDER and ETCFOLDER.

version: "3.8"

services:
  clamav:
    image: "mkodockx/docker-clamav"
    container_name: "clamav"
    volumes:
        - "${DATAFOLDER}:/data"
    expose :
        - "3310"        
    networks :
        - preingest-network        
  xslweb:
    image: "pmasereeuwnha/xslweb"
    container_name: "xslweb"
    volumes:
        - "${DATAFOLDER}:/data"
        - "${ETCFOLDER}:/data/etc"
    expose:
        - "8080" 
    networks :
        - preingest-network
  xslwebfrontend:
    image: "pmasereeuwnha/xslwebfrontend"
    container_name: "xslwebfrontend"
    volumes:
        - "${DATAFOLDER}:/data"
        - "${ETCFOLDER}:/data/etc"
    expose:
        - "8080" 
    ports:
        - "8888:8080"     
    networks :
        - preingest-network
  droid:
    image: "nhapreingest/noordhollandsarchiefdroidvalidationwebapi:development"
    container_name: "droid"
    volumes:
        - "${DATAFOLDER}:/data" 
    expose:
        - "8080"     
    networks :
        - preingest-network        
  preingest:
    image: "nhapreingest/noordhollandsarchiefpreingestwebapi:development"
    container_name: "Noord.HollandsArchief.Pre.Ingest.WebApi"
    volumes:
        - "${DATAFOLDER}:/data"  
    expose:
        - "80"
    # Only (temporarily) mapped here for direct debugging access to the API's HTTP endpoints
    ports:
      - "8000:80"
    networks :
        - preingest-network          
    depends_on:
      - droid
      - clamav
      - xslweb 
  webtool:
    image: "nhapreingest/noordhollandsarchiefpreingestwebtool:development"
    container_name: "Noord.HollandsArchief.Pre.Ingest.WebTool"
    volumes:
        - "${DATAFOLDER}:/data"  
    expose:
        - "80"      
    ports:
        - "8080:80"     
    networks :
        - preingest-network
    depends_on:
        - preingest
networks:
    preingest-network:
        driver: bridge
